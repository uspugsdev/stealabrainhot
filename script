-- Carrega a kwargs UI Library
local Lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/7yhx/kwargs_Ui_Library/main/source.lua"))()

local UI = Lib:Create{
   Theme = "Dark",
   Size = UDim2.new(0, 555, 0, 300)
}

local Main = UI:Tab{
   Name = "Main"
}

local Tools = Main:Divider{
   Name = "Ferramentas"
}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera
local LP = Players.LocalPlayer
local Character = LP.Character or LP.CharacterAdded:Wait()
local HRP = Character:WaitForChild("HumanoidRootPart")

local ESP_ENABLED = false
local FLY_ENABLED = false
local NOCLIP_ENABLED = false
local WALKSPEED_ENABLED = false
local flySpeed = 50
local espBoxes = {}

-- ESP
local function createESP(player)
    if player ~= LP then
        local box = Drawing.new("Text")
        box.Visible = false
        box.Color = Color3.fromRGB(0, 255, 255)
        box.Size = 14
        box.Center = true
        box.Outline = true
        box.Text = player.Name
        espBoxes[player] = box
    end
end

for _, plr in pairs(Players:GetPlayers()) do createESP(plr) end
Players.PlayerAdded:Connect(createESP)

RunService.RenderStepped:Connect(function()
    if ESP_ENABLED then
        for player, box in pairs(espBoxes) do
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local pos, onScreen = Camera:WorldToViewportPoint(player.Character.HumanoidRootPart.Position)
                box.Position = Vector2.new(pos.X, pos.Y)
                box.Visible = onScreen
            else
                box.Visible = false
            end
        end
    else
        for _, box in pairs(espBoxes) do box.Visible = false end
    end
end)

-- Fly reto
RunService.RenderStepped:Connect(function()
    if FLY_ENABLED and HRP then
        local dir = Vector3.zero
        local uis = game:GetService("UserInputService")
        if uis:IsKeyDown(Enum.KeyCode.W) then dir += Camera.CFrame.LookVector end
        if uis:IsKeyDown(Enum.KeyCode.S) then dir -= Camera.CFrame.LookVector end
        if uis:IsKeyDown(Enum.KeyCode.A) then dir -= Camera.CFrame.RightVector end
        if uis:IsKeyDown(Enum.KeyCode.D) then dir += Camera.CFrame.RightVector end
        HRP.Velocity = dir.Unit * flySpeed
    end
end)

-- Noclip
RunService.Stepped:Connect(function()
    if NOCLIP_ENABLED and Character then
        for _, part in ipairs(Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- WalkSpeed
local function updateWalkSpeed()
    local hum = LP.Character and LP.Character:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.WalkSpeed = WALKSPEED_ENABLED and 32 or 16
    end
end

-- Botões no painel
Tools:Toggle{
   Name = "ESP All",
   Description = "Ativa/desativa ESP para todos os jogadores.",
   Callback = function(state)
       ESP_ENABLED = state
   end
}

Tools:Toggle{
   Name = "Fly",
   Description = "Ativa voo reto com WASD.",
   Callback = function(state)
       FLY_ENABLED = state
   end
}

Tools:Toggle{
   Name = "Noclip",
   Description = "Atravessar paredes (sem colisão).",
   Callback = function(state)
       NOCLIP_ENABLED = state
   end
}

Tools:Toggle{
   Name = "Speed Boost",
   Description = "Aumenta velocidade do jogador.",
   Callback = function(state)
       WALKSPEED_ENABLED = state
       updateWalkSpeed()
   end
}
